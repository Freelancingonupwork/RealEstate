@using System.IO;
@model LeadViewModel
@{
    ViewData["Title"] = "LeadDetail";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
@{
    int userTypeAdmin = 0;
    if (Context.Request.Cookies.ContainsKey("UserLoginTypeId"))
    {
        userTypeAdmin = Convert.ToInt32(Context.Request.Cookies["UserLoginTypeId"]);
    }

    int AccountId = Convert.ToInt32(Context.Request.Cookies["LoginAccountId"].ToString());

}
<style type="text/css">
    .circle__spinner {
        animation: 2s linear infinite svg-animation;
        max-width: 100px;
    }

    .circle_loader {
        width: 100%;
        height: 100vh;
        display: flex;
        align-items: center;
        justify-content: center;
        position: fixed;
        top: 0px;
        left: 0px;
        z-index: 9999;
        background-color: rgba(0,0,0,0.6);
    }

    .circle__item {
        width: 200px;
        height: 200px;
    }
</style>
<link href="~/css/select2.css" rel="stylesheet" />
<link href="~/css/select2.min.css" rel="stylesheet" />
<div class="modal fade" id="divAssignAgent" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLongTitle">Assign Agent</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div role="alert" id="divErrorMsgAgent" style="display:none"></div>
                <label>Agent:</label><select id="cmbAgent" asp-items="@(new SelectList(ViewBag.AgentList,"Key","Value"))" class="form-control">
                    <option value="0">---Select Agent--</option>
                </select>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                <button type="button" onclick="fnUpdateAgent()" class="btn btn-primary">Save changes</button>
            </div>
        </div>
    </div>
</div>
<div class="modal fade" id="divAssignStageModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLongTitle">Assign Stage</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div role="alert" id="divErrorMsgStage" style="display:none"></div>
                <label>Stage:</label><select id="cmbStage" asp-items="@(new SelectList(ViewBag.StageList,"Key","Value"))" class="form-control">
                    <option value="0">---Select Stage--</option>
                </select>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                <button type="button" onclick="fnUpdateStage()" class="btn btn-primary">Save changes</button>
            </div>
        </div>
    </div>
</div>
<div class="modal fade" id="AssignTagModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLongTitle">Assign Tag</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div role="alert" id="divErrorMsgTag" style="display:none"></div>
                <label>Tag:</label>
                <select id="cmbtag" asp-items="@(new SelectList(ViewBag.TagList,"Key","Value"))" class="form-control" multiple>
                    @*<option value="0">---Select Tag--</option>*@
                </select>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                <button type="button" onclick="fnAssignTag()" class="btn btn-primary">Save changes</button>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="divCustomFieldValueModel" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLongTitle">Set Custom Field Value</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div role="alert" id="divErrorMsgStage" style="display:none"></div>
                <input type="hidden" id="hdnAccountID" />
                <input type="hidden" id="hdnCustomFieldId" />
                <input type="hidden" id="hdnCustomFieldTypeId" />
                <label id="CustomFiedlTitle"></label><input id="txtCustomFieldValue" class="form-control" /><br />
                <select class="form-control" id="cmbcustomFieldType" style="display:none"></select>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                <button type="button" onclick="fnUpdateCustomFieldDetails(@Model.LeadId)" class="btn btn-primary">Save changes</button>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="divAppointmentsModel" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="ModalTitle"></h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div role="alert" id="divErrorMsgAppointments" style="display:none"></div>
                <input type="hidden" id="hdnAccountID" />
                <input type="hidden" id="hdnCustomFieldId" />
                <input type="hidden" id="hdnCustomFieldTypeId" />
                <input type="hidden" id="hdnLeadAppointmentId" />
                <div class="row mt-2">
                    <div class="col-md-12">
                        <label>Title</label><input type="text" id="txtAppointmentTitle" class="form-control" placeholder="Title" />
                    </div>
                </div>
                <div class="row mt-2">
                    <div class="col-md-12">
                        <label>Description</label><textarea id="txtDescription" cols="40" rows="3" class="form-control" placeholder="Description"></textarea>
                    </div>
                </div>
                <div class="row mt-2">
                    <div class="col-md-6">
                        <label>Type</label>
                        <select id="cmdAppointmentType" asp-items="@(new SelectList(ViewBag.AppointmentTypeslist,"Key","Value"))" class="form-control">
                            <option value="0">No type</option>
                        </select>
                    </div>
                    <div class="col-md-6">
                        <label>Outcome</label>
                        <select id="cmdAppointmentOutcomes" asp-items="@(new SelectList(ViewBag.AppointmentOutcomeslist,"Key","Value"))" class="form-control">
                            <option value="0">No outcome</option>
                        </select>
                    </div>
                </div>
                <div class="row mt-4">
                    <div class="col-md-6">
                        <label>Time</label>
                        <input type="text" id="datepicker" class="form-control">

                        @*<div class="col-md-2" style="text-align:center">To</div>
                            <div class="col-md-3"><input type="text" id="datepickerto" class="form-control"></div>
                            <div class="col-md-2"><input type="text" id="timepickerto" class="form-control"></div>*@
                    </div>
                    <div class="col-md-6">
                        <label>&nbsp;&nbsp;</label>
                        <input type="text" id="timepicker" class="form-control">
                        @*<div class="col-md-2" style="text-align:center">To</div>
                            <div class="col-md-3"><input type="text" id="datepickerto" class="form-control"></div>
                            <div class="col-md-2"><input type="text" id="timepickerto" class="form-control"></div>*@
                    </div>
                </div>
                <div class="row mt-2">
                    <div class="col-md-12">
                        <label>Location</label><input type="text" id="txtLocation" class="form-control" placeholder="Location" />
                    </div>
                </div>
                <div class="row mt-2">
                    <div class="col-md-12">
                        <label>Invitees:</label>
                        <select id="cmbInvitees" asp-items="@(new SelectList(ViewBag.AgentList,"Key","Value"))" class="form-control" multiple>
                        </select>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                <button type="button" id="BtCreateAppointment" onclick="fnCreateLeadAppointMent(@Model.LeadId)" class="btn btn-primary">Create Appointment</button>
                <button type="button" style="display:none" id="BtnSave" onclick="fnUpdateLeadAppointMent(@Model.LeadId)" class="btn btn-primary">Save</button>
            </div>
        </div>
    </div>
</div>

<div class="modal fade" id="divLeadFileModel" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLongTitle">Upload File</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div role="alert" id="divErrorMsgLeadFile" style="display:none"></div>
                <input type="file" id="fileInput" multiple />
                <button type="submit" class="btn btn-primary" onclick="fnUploadLeadFile(@Model.LeadId)">Upload Files</button>
                <div class="table-wrapper-scroll-y my-custom-scrollbar mb-0">
                    <table class="table table-bordered table-striped mt-2" id="FilesList" style="display:none">
                        <tr>
                            <th>
                                Attachment(s)
                            </th>
                            <th>
                                Action
                            </th>
                        </tr>
                    </table>
                </div>
            </div>
            <div class="modal-footer">
                @*<button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                    <button type="button" onclick="fnUpdateAgent()" class="btn btn-primary">Save changes</button>*@
            </div>
        </div>
    </div>
</div>
<div role="alert" id="divAlertMessage" style="display:none"></div>
<div class="circle_loader" id="divLoader" style="display:none;">
    <div class="circle__item">
        <svg class="circle__spinner" viewBox="0 0 100 100">
            <circle class="path" cx="50" cy="50" r="45" fill="none" stroke="#93bfec" stroke-width="1"></circle>
        </svg>
    </div>
</div>
<div class="content-wrapper">
    <div class="container-fluid">
        <div class="row">
            <div class="col-12 col-lg-3">
                <div class="content-bg">
                    <p class="mb-0">Person 1 of 1</p>
                </div>
                <input type="hidden" id="hdnLeadID" value="@Model.LeadId" />
                @*<div class="content-bg mt-3">
                        <div class="row">
                            <div class="custom-card-header">
                                <div class="content-header-left align-items-center">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                                         fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                         stroke-linejoin="round" class="feather feather-list">
                                        <line x1="8" y1="6" x2="21" y2="6"></line>
                                        <line x1="8" y1="12" x2="21" y2="12"></line>
                                        <line x1="8" y1="18" x2="21" y2="18"></line>
                                        <line x1="3" y1="6" x2="3.01" y2="6"></line>
                                        <line x1="3" y1="12" x2="3.01" y2="12"></line>
                                        <line x1="3" y1="18" x2="3.01" y2="18"></line>
                                    </svg>
                                    Tasks <span class="ml-1" class="number-text">(2)</span>
                                </div>
                                <div class="content-header-right">
                                    <button class="btn-icon">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                             viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                                             stroke-linecap="round" stroke-linejoin="round" class="feather feather-zap">
                                            <polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"></polygon>
                                        </svg>
                                    </button>
                                    <button class="btn-icon">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                             viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                                             stroke-linecap="round" stroke-linejoin="round" class="feather feather-plus">
                                            <line x1="12" y1="5" x2="12" y2="19"></line>
                                            <line x1="5" y1="12" x2="19" y2="12"></line>
                                        </svg>
                                    </button>
                                    <button class="btn-icon">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                             viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                                             stroke-linecap="round" stroke-linejoin="round"
                                             class="feather feather-chevron-down">
                                            <polyline points="6 9 12 15 18 9"></polyline>
                                        </svg>
                                    </button>
                                </div>
                            </div>
                            <div class="custom-card-text">
                                <div class="task-detail-wrapper">
                                    <div class="form-checkbox-group mr-2">
                                        <input type="checkbox" id="rememberMe">
                                        <label for="rememberMe"></label>
                                    </div>
                                    <div class="task-detail">
                                        <ul>
                                            <li>
                                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                                     viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                                     stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                                                     class="feather feather-phone">
                                                    <path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z">
                                                    </path>
                                                </svg> Follow Up Call
                                            </li>
                                            <li>
                                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                                     viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                                     stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                                                     class="feather feather-calendar">
                                                    <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                                                    <line x1="16" y1="2" x2="16" y2="6"></line>
                                                    <line x1="8" y1="2" x2="8" y2="6"></line>
                                                    <line x1="3" y1="10" x2="21" y2="10"></line>
                                                </svg> Feb 5th 2021
                                            </li>
                                            <li>
                                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                                     viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                                     stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                                                     class="feather feather-user">
                                                    <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                                                    <circle cx="12" cy="7" r="4"></circle>
                                                </svg>
                                                </svg> Ifiok Charles
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                                <div class="task-detail-wrapper mt-2">
                                    <div class="form-checkbox-group mr-2">
                                        <input type="checkbox" id="rememberMe">
                                        <label for="rememberMe"></label>
                                    </div>
                                    <div class="task-detail">
                                        <ul>
                                            <li>
                                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                                     viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                                     stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                                                     class="feather feather-message-square">
                                                    <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z">
                                                    </path>
                                                </svg> Follow Up Text
                                            </li>
                                            <li>
                                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                                     viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                                     stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                                                     class="feather feather-user">
                                                    <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                                                    <circle cx="12" cy="7" r="4"></circle>
                                                </svg>
                                                </svg> Ifiok Charles
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>*@
                <div class="content-bg mt-3">
                    <div class="row">
                        <div class="custom-card-header">
                            <div class="content-header-left align-items-center">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                                     fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                     stroke-linejoin="round" class="feather feather-calendar">
                                    <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                                    <line x1="16" y1="2" x2="16" y2="6"></line>
                                    <line x1="8" y1="2" x2="8" y2="6"></line>
                                    <line x1="3" y1="10" x2="21" y2="10"></line>
                                </svg>
                                Appointments
                            </div>
                            <div class="content-header-right">
                                @if (userTypeAdmin == RoleType.Admin.GetHashCode())
                                {
                                    <button class="btn-icon" onclick="fnPopulateControlsAppointment(@Model.LeadId)" data-toggle="modal" data-target="#divAppointmentsModel">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                             viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                                             stroke-linecap="round" stroke-linejoin="round" class="feather feather-plus">
                                            <line x1="12" y1="5" x2="12" y2="19"></line>
                                            <line x1="5" y1="12" x2="19" y2="12"></line>
                                        </svg>
                                    </button>
                                }
                                <button class="btn-icon collapsible">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                         viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                                         stroke-linecap="round" stroke-linejoin="round"
                                         class="feather feather-chevron-down">
                                        <polyline points="6 9 12 15 18 9"></polyline>
                                    </svg>
                                </button>
                            </div>
                        </div>

                        <div id="divScroll" class="custom-card-text upcoming-appointment" style="max-height:140px;overflow:auto;">
                            @if (Model.LeadAppointments.Count > 0)
                            {
                                foreach (var item in Model.LeadAppointments.OrderByDescending(x => x.LeadAppointmentId))
                                {
                                    <div class="appointment-title">
                                        <h6><span>@item.Title</span></h6>
                                        <div>
                                            @if (userTypeAdmin == RoleType.Admin.GetHashCode())
                                            {
                                                <a onclick="GetLeadAppointmentValue(@Model.LeadId,@item.LeadAppointmentId)" data-toggle="modal" data-target="#divAppointmentsModel">
                                                    <b><i style="color:#BF0D1C" class="fa fa-pencil-square-o" aria-hidden="true"></i></b>
                                                </a>
                                                <a onclick="return ConfirmationDialogAppointMent(@Model.LeadId,@item.LeadAppointmentId)">
                                                    <b><i style="color:#BF0D1C" class="fa fa-trash" aria-hidden="true"></i></b>
                                                </a>
                                            }
                                        </div>
                                    </div>
                                    <ul>
                                        <li>
                                            <b><i style="color:#BF0D1C" class="fa fa-calendar" aria-hidden="true"></i></b>
                                            <span>@item.AppointmentDateTime.Value.ToString("MM/dd/yyy hh:mm tt").Replace("-", "/")</span>
                                        </li>
                                        <li>
                                            <b><i style="color:#BF0D1C" class="fa fa-map-marker" aria-hidden="true"></i></b>
                                            <span> @(item.Location == "" ? "N/A" : item.Location)</span>
                                        </li>
                                        <li>
                                            <b><i style="color:#BF0D1C" class="fa fa-envelope" aria-hidden="true"></i></b>
                                            <span>@item.Lead.EmailAddress</span>
                                        </li>
                                        <li>
                                            <b><i style="color:#BF0D1C" class="fa fa-envelope" aria-hidden="true"></i></b>
                                            @*<span>@(item.Agent == null ? "N/A" : item.Agent.UserName)</span>*@
                                            <span>@(item.Account == null ? "N/A" : item.Account.UserName)</span>
                                        </li>
                                    </ul>
                                    <hr />
                                }
                            }
                            else
                            {
                                <p>No Upcoming Appointments</p>
                            }

                        </div>
                    </div>
                </div>
                @*<div class="content-bg mt-3">
                        <div class="row">
                            <div class="custom-card-header">
                                <div class="content-header-left align-items-center">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                                         fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                         stroke-linejoin="round" class="feather feather-paperclip">
                                        <path d="M21.44 11.05l-9.19 9.19a6 6 0 0 1-8.49-8.49l9.19-9.19a4 4 0 0 1 5.66 5.66l-9.2 9.19a2 2 0 0 1-2.83-2.83l8.49-8.48">
                                        </path>
                                    </svg>
                                    Files
                                </div>
                                <div class="content-header-right">
                                    @if (userTypeAdmin == RoleType.Admin.GetHashCode())
                                    {
                                        <button class="btn-icon" onclick="fnPopulateControlsLeadFile(@Model.LeadId)" data-toggle="modal" data-target="#divLeadFileModel">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                                 viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                                                 stroke-linecap="round" stroke-linejoin="round" class="feather feather-plus">
                                                <line x1="12" y1="5" x2="12" y2="19"></line>
                                                <line x1="5" y1="12" x2="19" y2="12"></line>
                                            </svg>
                                        </button>
                                    }
                                    <button class="btn-icon">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                             viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                                             stroke-linecap="round" stroke-linejoin="round"
                                             class="feather feather-chevron-down">
                                            <polyline points="6 9 12 15 18 9"></polyline>
                                        </svg>
                                    </button>
                                </div>
                            </div>
                            <div class="custom-card-text">
                                @if (Model.LeadFiles.Count > 0)
                                {
                                    foreach (var item in Model.LeadFiles.OrderByDescending(x => x.LeadFileId))
                                    {
                                        string extension = System.IO.Path.GetExtension(item.FileName);
                                        string[] values = new[] { ".jpeg", ".jpg", ".png", ".gif", ".bmp", ".svg" };
                                        bool containsAny = values.Any(extension.Contains);
                                        <div class="file-lead">
                                            <div class="fileImg">
                                                @if (containsAny)
                                                {
                                                    <a target="_blank" asp-action="DownloadFile" asp-route-id="@item.LeadId" asp-route-fileName="@item.FileName">
                                                        <img src="~/LeadFile/@AccountId/@Model.LeadId/@item.FileName" width="80" height="60" />
                                                    </a>
                                                }
                                                else
                                                {
                                                    <div target="_blank" asp-action="DownloadFile" asp-route-id="@item.LeadId" asp-route-fileName="@item.FileName">
                                                        @extension.Replace(".", "")
                                                    </div>
                                                }
                                            </div>
                                            <div class="fileDetails">
                                                <p class="mb-0" data-toggle="tooltip" data-placement="top" title="@item.FileName">
                                                    @item.FileName
                                                </p>
                                                <p class="mb-0" style="color:rgb(154, 158, 161)">@item.CreatedDate.Value.ToString("MMMM dd,yyyy hh:mm tt")</p>
                                                <div class="deleteFilebtn d-flex">
                                                    <a asp-action="DownloadFile" asp-route-id="@item.LeadId" asp-route-fileName="@item.FileName" data-toggle="tooltip" data-placement="top" title="Download">
                                                        <b><i style="color:#BF0D1C" class="fa fa-download" aria-hidden="true"></i></b>
                                                    </a>
                                                    @if (userTypeAdmin == RoleType.Admin.GetHashCode())
                                                    {
                                                        <a onclick="return ConfirmationDialogLeadFile(@Model.LeadId,@item.LeadFileId)" data-toggle="tooltip" data-placement="top" title="Delete">
                                                            <b><i style="color:#BF0D1C" class="fa fa-trash" aria-hidden="true"></i></b>
                                                        </a>
                                                    }
                                                </div>
                                            </div>
                                        </div>
                                    }
                                }
                                else
                                {
                                    <p>No files yet</p>
                                }
                            </div>
                        </div>
                    </div>*@
                @*<div class="content-bg mt-3">
                        <div class="row">
                            <div class="custom-card-header">
                                <div class="content-header-left align-items-center">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                                         fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                         stroke-linejoin="round" class="feather feather-percent">
                                        <line x1="19" y1="5" x2="5" y2="19"></line>
                                        <circle cx="6.5" cy="6.5" r="2.5"></circle>
                                        <circle cx="17.5" cy="17.5" r="2.5"></circle>
                                    </svg>
                                    Deals
                                </div>
                                <div class="content-header-right">
                                    <button class="btn-icon">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                             viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                                             stroke-linecap="round" stroke-linejoin="round" class="feather feather-plus">
                                            <line x1="12" y1="5" x2="12" y2="19"></line>
                                            <line x1="5" y1="12" x2="19" y2="12"></line>
                                        </svg>
                                    </button>
                                    <button class="btn-icon">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                             viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                                             stroke-linecap="round" stroke-linejoin="round"
                                             class="feather feather-chevron-down">
                                            <polyline points="6 9 12 15 18 9"></polyline>
                                        </svg>
                                    </button>
                                </div>
                            </div>
                            <div class="custom-card-text">
                                <p>No Deals Yet</p>
                            </div>
                        </div>
                    </div>
                    <div class="content-bg mt-3">
                        <div class="row">
                            <div class="custom-card-header">
                                <div class="content-header-left align-items-center">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                                         fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                         stroke-linejoin="round" class="feather feather-users">
                                        <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
                                        <circle cx="9" cy="7" r="4"></circle>
                                        <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
                                        <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
                                    </svg>
                                    Collaborators
                                </div>
                                <div class="content-header-right">
                                    <button class="btn-icon">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                             viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                                             stroke-linecap="round" stroke-linejoin="round" class="feather feather-plus">
                                            <line x1="12" y1="5" x2="12" y2="19"></line>
                                            <line x1="5" y1="12" x2="19" y2="12"></line>
                                        </svg>
                                    </button>
                                    <button class="btn-icon">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                             viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                                             stroke-linecap="round" stroke-linejoin="round"
                                             class="feather feather-chevron-down">
                                            <polyline points="6 9 12 15 18 9"></polyline>
                                        </svg>
                                    </button>
                                </div>
                            </div>
                            <div class="custom-card-text">
                                <p>No Collaboration</p>
                            </div>
                        </div>
                    </div>
                    <div class="content-bg mt-3">
                        <div class="row">
                            <div class="custom-card-header">
                                <div class="content-header-left align-items-center">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                                         fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                         stroke-linejoin="round" class="feather feather-play-circle">
                                        <circle cx="12" cy="12" r="10"></circle>
                                        <polygon points="10 8 16 12 10 16 10 8"></polygon>
                                    </svg>
                                    Action Plans
                                </div>
                                <div class="content-header-right">
                                    <button class="btn-icon">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                             viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                                             stroke-linecap="round" stroke-linejoin="round" class="feather feather-plus">
                                            <line x1="12" y1="5" x2="12" y2="19"></line>
                                            <line x1="5" y1="12" x2="19" y2="12"></line>
                                        </svg>
                                    </button>
                                    <button class="btn-icon">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                             viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                                             stroke-linecap="round" stroke-linejoin="round"
                                             class="feather feather-chevron-down">
                                            <polyline points="6 9 12 15 18 9"></polyline>
                                        </svg>
                                    </button>
                                </div>
                            </div>
                            <div class="custom-card-text">
                                <p>No Action Plan Running</p>
                            </div>
                        </div>
                    </div>
                    <div class="content-bg mt-3">
                        <div class="row">
                            <div class="custom-card-header">
                                <div class="content-header-left align-items-center">

                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                                         fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                                         stroke-linejoin="round" class="feather feather-activity">
                                        <polyline points="22 12 18 12 15 21 9 3 6 12 2 12"></polyline>
                                    </svg>
                                    Activity
                                </div>
                                <div class="content-header-right">
                                    Seen a month Ago
                                    <button class="btn-icon ml-2">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                             viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                                             stroke-linecap="round" stroke-linejoin="round"
                                             class="feather feather-chevron-down">
                                            <polyline points="6 9 12 15 18 9"></polyline>
                                        </svg>
                                    </button>
                                </div>
                            </div>
                            <div class="custom-card-text">
                                <h6>MARKETING SOURCE</h6>
                                <p><svg width="15" height="16" viewBox="0 0 15 16" fill="none" xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMinYMid"><path d="M9.84807 4.31416C9.92126 4.2979 9.95379 4.3223 9.99851 4.37109C10.2506 4.65165 11.0557 5.63565 11.2753 5.90402C11.3159 5.95281 11.2875 6.00567 11.2549 6.03414C9.6285 7.30277 7.81907 9.1 6.81067 10.3849C6.79034 10.4134 6.8066 10.4134 6.82287 10.4093C8.57944 9.65299 12.7066 8.44535 14.5648 8.10786V5.75357L7.29047 0L0.00397083 5.74951V8.32337C2.26067 6.98154 7.48158 4.90375 9.84807 4.31416Z" fill="#0171FB"></path><path d="M3.92788 14.2028C3.86689 14.2353 3.81809 14.2272 3.7693 14.1784L2.41121 12.5601C2.37462 12.5153 2.37055 12.4909 2.41935 12.4218C3.46841 10.8848 5.61126 8.48986 6.97748 7.47739C7.00187 7.46113 6.99374 7.4408 6.96528 7.453C5.54213 7.91654 1.49634 9.65684 0 10.5026V16H14.5608V10.7059C12.5765 11.0434 6.63186 12.8122 3.92788 14.2028Z" fill="#0171FB"></path></svg> Zillow</p>
                            </div>
                        </div>
                    </div>*@
            </div>
            <div class="col-12 col-lg-9">
                <div class="content-bg">
                    <div class="timeline-img">
                        <img src="~/image/timeline-bg.jpg" alt="timeline image" />
                    </div>
                    <div class="row">
                        <div class="col-12 col-lg-3">
                            <div class="row">
                                <div class="profile-img-big">
                                    @if (string.IsNullOrEmpty(Model.OwnerImg))
                                    {<img src="~/LeadProfilePicture/default.png" alt="profile-img" />}
                                    else
                                    {<img src="~/LeadProfilePicture/@Model.OwnerImg" alt="profile-img" />}
                                </div>
                            </div>
                        </div>
                        <div class="col-12 col-lg-8">
                            <div class="row justify-content-between profile-detail-text">
                                <div class="profile-name">
                                    <h4>@Model.FirstName @Model.LastName</h4>
                                    <p>Last communication one week ago</p>
                                    <button onclick="return ConfirmationDialog(@Model.LeadId)" class="btn btn-primary">Delete Person</button>
                                </div>
                                <div class="profile-phone">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                         viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                                         stroke-linecap="round" stroke-linejoin="round"
                                         class="feather feather-phone">
                                        <path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z">
                                        </path>
                                    </svg>
                                    <a href="tel:@Model.MobileNumber">
                                        @(Model.MobileNumber != null ? Model.MobileNumber : "N/A")
                                    </a>
                                    <a href="tel:@Model.PhoneNumber">
                                        @(Model.PhoneNumber != null ? Model.PhoneNumber : "N/A")
                                    </a>
                                </div>
                                <div class="profile-mail">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                         viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                                         stroke-linecap="round" stroke-linejoin="round" class="feather feather-mail">
                                        <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z">
                                        </path>
                                        <polyline points="22,6 12,13 2,6"></polyline>
                                    </svg>
                                    <a href="mailto:@Model.EmailAddress">@Model.EmailAddress</a>
                                    <a href="mailto:@Model.SecondaryEmail">@Model.SecondaryEmail</a>
                                </div>
                                <div class="profile-address">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                         viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                                         stroke-linecap="round" stroke-linejoin="round"
                                         class="feather feather-map-pin">
                                        <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path>
                                        <circle cx="12" cy="10" r="3"></circle>
                                    </svg>
                                    <p>@(Model.Street != null ? Model.Street : "N/A")</p>
                                    <p>@(Model.City != null ? Model.City : "N/A") , @(Model.State != null ? Model.State : "N/A")</p>
                                    <p>@(Model.Country != null ? Model.Country : "N/A")</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row px-2">
                        <div class="col-12 col-lg-3 px-1">
                            <div class="profile-card-wrapper">
                                <div class="custom-card-header">
                                    <div class="content-header-left align-items-center">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                             viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                                             stroke-linecap="round" stroke-linejoin="round"
                                             class="feather feather-list">
                                            <line x1="8" y1="6" x2="21" y2="6"></line>
                                            <line x1="8" y1="12" x2="21" y2="12"></line>
                                            <line x1="8" y1="18" x2="21" y2="18"></line>
                                            <line x1="3" y1="6" x2="3.01" y2="6"></line>
                                            <line x1="3" y1="12" x2="3.01" y2="12"></line>
                                            <line x1="3" y1="18" x2="3.01" y2="18"></line>
                                        </svg>
                                        Details
                                    </div>
                                    <div class="content-header-right">
                                        <button class="btn-icon">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                                 viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                                 stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                                                 class="feather feather-chevron-down">
                                                <polyline points="6 9 12 15 18 9"></polyline>
                                            </svg>
                                        </button>
                                    </div>
                                </div>
                                <div class="custom-card-text">
                                    @*<p><strong>Stage</strong><span>@(Model.Stage != null ? Model.Stage.StageName : "N/A")</span></p>*@
                                    @if (userTypeAdmin == RoleType.Admin.GetHashCode())
                                    {
                                        @if (Convert.ToInt32(Model.StageId) <= 0)
                                        {
                                            @*<p>
                                                    <strong>Stage</strong>
                                                    <span><font color="red">Not Assigned</font> &nbsp;&nbsp;<a href="#" style="color:#ffffff" onclick="setStageValue(0)" data-toggle="modal" data-target="#divAssignStageModal"><i class="fa fa-pencil"></i></a></span>
                                                </p>*@
                                            <div class="follow-us">
                                                <strong>Stage</strong>
                                                <div class="follow-us-inner"><span>Not Assigned</span>&nbsp;&nbsp;<a href="#" style="color:#ffffff" onclick="setStageValue(0)" data-toggle="modal" data-target="#divAssignStageModal"><i class="fa fa-pencil"></i></a></div>
                                            </div>
                                        }
                                        else
                                        {
                                            @*<p>
                                                    <strong>Stage</strong>
                                                    <span>@Model.Stage.StageName &nbsp;&nbsp;<a href="#" style="color:#ffffff" onclick="setStageValue(@Model.StageId)" data-toggle="modal" data-target="#divAssignStageModal"><i class="fa fa-pencil"></i></a></span>
                                                </p>*@
                                            <div class="follow-us">
                                                <strong>Stage</strong>
                                                <div class="follow-us-inner"><span>@Model.Stage.StageName</span>&nbsp;&nbsp;<a href="#" style="color:#ffffff" onclick="setStageValue(@Model.StageId)" data-toggle="modal" data-target="#divAssignStageModal"><i class="fa fa-pencil"></i></a></div>
                                            </div>
                                        }
                                    }
                                    else
                                    {
                                        @if (Convert.ToInt32(Model.StageId) <= 0)
                                        {
                                            @*<p>
                                                    <strong>Stage</strong>
                                                    <span><font color="red">Not Assigned</font> </span>
                                                </p>*@
                                            <div class="follow-us">
                                                <strong>Stage</strong>
                                                <div class="follow-us-inner"><span>Not Assigned</span></div>
                                            </div>
                                        }
                                        else
                                        {
                                            @*<p>
                                                    <strong>Stage</strong>
                                                    <span>@Model.Stage.StageName </span>
                                                </p>*@
                                            <div class="follow-us">
                                                <strong>Stage</strong>
                                                <div class="follow-us-inner"><span>@Model.Stage.StageName</span></div>
                                            </div>
                                        }
                                    }
                                    <div class="follow-us"><strong>Source</strong><div class="follow-us-inner"><span>@(Model.LeadSource != null ? Model.LeadSource : "N/A")</span></div></div>

                                    @if (userTypeAdmin == RoleType.Admin.GetHashCode())
                                    {
                                        @if (Convert.ToInt32(Model.AgentId) <= 0)
                                        {
                                            @*<p>
                                                    <strong>Agent</strong>
                                                    <span><font color="red">Not Assigned</font> &nbsp;&nbsp;<a href="#" style="color:#ffffff" onclick="setAgentValue(0)" data-toggle="modal" data-target="#divAssignAgent"><i class="fa fa-pencil"></i></a></span>
                                                </p>*@
                                            <div class="follow-us">
                                                <strong>Agent</strong>
                                                <div class="follow-us-inner">
                                                    <span>Not Assigned</span>&nbsp;&nbsp;<a href="#" style="color:#ffffff" onclick="setAgentValue(0)" data-toggle="modal" data-target="#divAssignAgent"><i class="fa fa-pencil"></i></a>
                                                </div>
                                            </div>
                                        }
                                        else
                                        {
                                            @*<p>
                                                    <strong>Agent</strong>
                                                    <span>@Model.Agent.FullName &nbsp;&nbsp;<a href="#" style="color:#ffffff" onclick="setAgentValue(@Model.AgentId)" data-toggle="modal" data-target="#divAssignAgent"><i class="fa fa-pencil"></i></a></span>
                                                </p>*@
                                            <div class="follow-us">
                                                <strong>Agent</strong>
                                                <div class="follow-us-inner">
                                                    <span>@Model.Agent.FullName</span>&nbsp;&nbsp;<a href="#" style="color:#ffffff" onclick="setAgentValue(@Model.AgentId)" data-toggle="modal" data-target="#divAssignAgent"><i class="fa fa-pencil"></i></a>
                                                </div>
                                            </div>
                                        }
                                    }
                                    else
                                    {
                                        @if (Convert.ToInt32(Model.AgentId) <= 0)
                                        {
                                            @*<p>
                                                    <strong>Agent</strong>
                                                    <span><font color="red">Not Assigned</font> </span>
                                                </p>*@
                                            <div class="follow-us">
                                                <strong>Agent</strong>
                                                <div class="follow-us-inner">
                                                    <span>Not Assigned</span>
                                                </div>
                                            </div>
                                        }
                                        else
                                        {
                                            @*<p>
                                                    <strong>Agent</strong>
                                                    <span>@Model.Agent.FullName </span>
                                                </p>*@
                                            <div class="follow-us">
                                                <strong>Agent</strong>
                                                <div class="follow-us-inner">
                                                    <span>@Model.Agent.FullName</span>
                                                </div>
                                            </div>
                                        }
                                    }
                                    @*<p><strong>Lender</strong><span></span></p>
                                        <p><strong>Price</strong><span></span></p>*@
                                    @if (userTypeAdmin == RoleType.Admin.GetHashCode())
                                    {

                                        @if (Model.TagsName != "")
                                        {
                                            <div class="follow-us">
                                                <strong>Tag</strong>
                                                <div class="follow-us-inner">
                                                    @{
                                                        var tagList = Model.TagsName.Split(",");
                                                        foreach (var item in tagList)
                                                        {
                                                            <span class="btn-tag">@item</span>
                                                        }
                                                        <a href="#" style="color:#ffffff" onclick="setTagValue(@Model.LeadId)" data-toggle="modal" data-target="#AssignTagModal"><i class="fa fa-pencil"></i></a>
                                                    }
                                                </div>
                                            </div>
                                        }
                                        else
                                        {
                                            <div class="follow-us">
                                                <strong>Tag</strong>
                                                <div class="follow-us-inner">
                                                    <span class="btn-tag">Not Assigned</span>&nbsp;&nbsp;<a href="#" style="color:#ffffff" onclick="setTagValue(@Model.LeadId)" data-toggle="modal" data-target="#AssignTagModal"><i class="fa fa-pencil"></i></a>
                                                </div>
                                            </div>
                                        }
                                    }
                                    else
                                    {
                                        @if (Model.TagsName != "")
                                        {
                                            <div class="follow-us">
                                                <strong>Tag</strong>
                                                <div class="follow-us-inner">
                                                    @{
                                                        var tagList = Model.TagsName.Split(",");
                                                        foreach (var item in tagList)
                                                        {
                                                            <span class="btn-tag">@item</span>
                                                        }
                                                    }
                                                </div>
                                            </div>
                                        }
                                        else
                                        {
                                            <div class="follow-us">
                                                <strong>Tag</strong>
                                                <div class="follow-us-inner">
                                                    <span class="btn-tag">Not Assigned</span>
                                                </div>
                                            </div>
                                        }
                                    }

                                </div>
                            </div>
                        </div>
                        <div class="col-12 col-lg-3 px-1">
                            <div class="profile-card-wrapper">
                                <div class="custom-card-header">
                                    <div class="content-header-left align-items-center">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                             viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                                             stroke-linecap="round" stroke-linejoin="round"
                                             class="feather feather-list">
                                            <line x1="8" y1="6" x2="21" y2="6"></line>
                                            <line x1="8" y1="12" x2="21" y2="12"></line>
                                            <line x1="8" y1="18" x2="21" y2="18"></line>
                                            <line x1="3" y1="6" x2="3.01" y2="6"></line>
                                            <line x1="3" y1="12" x2="3.01" y2="12"></line>
                                            <line x1="3" y1="18" x2="3.01" y2="18"></line>
                                        </svg>
                                        Background
                                    </div>
                                    <div class="content-header-right">
                                        <button class="btn-icon">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                                 viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                                 stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                                                 class="feather feather-chevron-down">
                                                <polyline points="6 9 12 15 18 9"></polyline>
                                            </svg>
                                        </button>
                                    </div>
                                </div>
                                <div class="custom-card-text">
                                    <p>
                                        Estajo keeps all your leads, clients and past clients in one place,
                                        so you just have one place to login and follow up.
                                    </p>
                                    <p class="mt-1">
                                        Management, Estajo, Foreclosures, Email Marketing,
                                        Marketing, Internet Marketing, Social Media, Entrepreneurship, Advertising,
                                        Business, Mortgages, Crm, Movies, Mailchimp
                                    </p>

                                </div>
                            </div>
                        </div>
                        <div class="col-12 col-lg-3 px-1">
                            <div class="profile-card-wrapper">
                                <div class="custom-card-header">
                                    <div class="content-header-left align-items-center">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                             viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                                             stroke-linecap="round" stroke-linejoin="round"
                                             class="feather feather-list">
                                            <line x1="8" y1="6" x2="21" y2="6"></line>
                                            <line x1="8" y1="12" x2="21" y2="12"></line>
                                            <line x1="8" y1="18" x2="21" y2="18"></line>
                                            <line x1="3" y1="6" x2="3.01" y2="6"></line>
                                            <line x1="3" y1="12" x2="3.01" y2="12"></line>
                                            <line x1="3" y1="18" x2="3.01" y2="18"></line>
                                        </svg>
                                        Social Profile
                                    </div>
                                    <div class="content-header-right">
                                        <button class="btn-icon">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                                 viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                                 stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                                                 class="feather feather-chevron-down">
                                                <polyline points="6 9 12 15 18 9"></polyline>
                                            </svg>
                                        </button>
                                    </div>
                                </div>
                                <div class="custom-card-text">
                                    <p><strong>Skype</strong><span>@(Model.SkypeId != null ? Model.SkypeId : "N/A")</span></p>
                                    <p><strong>Twitter</strong><span>@(Model.TwitterId != null ? Model.TwitterId : "N/A")</span></p>
                                    @*<p><strong>Google</strong><span>Search Dan Corkill</span></p>
                                        <p><strong>Name</strong><span>Estajo</span></p>
                                        <p><strong>Location</strong><span>San Francisco</span></p>*@
                                </div>
                            </div>
                        </div>
                        <div class="col-12 col-lg-3 px-1">
                            <div class="profile-card-wrapper">
                                <div class="custom-card-header">
                                    <div class="content-header-left align-items-center">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                             viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                                             stroke-linecap="round" stroke-linejoin="round"
                                             class="feather feather-list">
                                            <line x1="8" y1="6" x2="21" y2="6"></line>
                                            <line x1="8" y1="12" x2="21" y2="12"></line>
                                            <line x1="8" y1="18" x2="21" y2="18"></line>
                                            <line x1="3" y1="6" x2="3.01" y2="6"></line>
                                            <line x1="3" y1="12" x2="3.01" y2="12"></line>
                                            <line x1="3" y1="18" x2="3.01" y2="18"></line>
                                        </svg>
                                        Custom Fields
                                    </div>
                                    <div class="content-header-right">
                                        <button class="btn-icon">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                                 viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                                 stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                                                 class="feather feather-chevron-down">
                                                <polyline points="6 9 12 15 18 9"></polyline>
                                            </svg>
                                        </button>
                                    </div>
                                </div>
                                <div class="custom-card-text">

                                    @if (userTypeAdmin == RoleType.Admin.GetHashCode())
                                    {
                                        @foreach (var item in ViewBag.CustomFieldlist)
                                        {
                                            <p>
                                                <strong>@item.Value</strong>
                                                @if (Model.CustomFieldAnswer.Where(x => x.CustomFieldId == item.Key).Count() > 0)
                                                {
                                                    @foreach (var itemAns in Model.CustomFieldAnswer.Where(x => x.CustomFieldId == item.Key))
                                                    {
                                                        if (itemAns.LeadId == Model.LeadId && itemAns.AccountId == AccountId)
                                                        {

                                                            @itemAns.FieldAns
                                                        }
                                                        else
                                                        {
                                                            <strong>@("N/A")</strong>
                                                        }
                                                    }
                                                }
                                                else
                                                {
                                                    <strong>@("N/A")</strong>
                                                }
                                                <a href="#" style="color:#ffffff" onclick="fnPopulateControls(@Model.LeadId,@item.Key)"><i class="fa fa-pencil"></i></a>
                                            </p>
                                        }
                                    }
                                    else
                                    {
                                        @foreach (var item in ViewBag.CustomFieldlist)
                                        {
                                            <p>
                                                <strong>@item.Value</strong>
                                                @if (Model.CustomFieldAnswer.Where(x => x.CustomFieldId == item.Key).Count() > 0)
                                                {
                                                    @foreach (var itemAns in Model.CustomFieldAnswer.Where(x => x.CustomFieldId == item.Key))
                                                    {
                                                        if (itemAns.LeadId == Model.LeadId) // && itemAns.AccountId == AccountId
                                                        {

                                                            @itemAns.FieldAns
                                                        }
                                                        else
                                                        {
                                                            <strong>@("N/A")</strong>
                                                        }
                                                    }
                                                }
                                                else
                                                {
                                                    <strong>@("N/A")</strong>
                                                }
                                            </p>
                                        }
                                    }
                                    @*<p><strong>Website</strong> @(Model.Website != null ? Model.Website : "N/A")</p>*@
                                    @*<p><strong>Birthday</strong><span></span></p>
                                        <p><strong>Close Date</strong><span></span></p>
                                        <p><strong>Commission</strong><span></span></p>
                                        <p><strong>Spouse Name</strong><span></span></p>*@
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="main-tab-wrapper mt-3">
                    <div class="content-bg">
                        <div class="row justify-content-between">
                            <ul class="nav nav-pills" id="pills-tab" role="tablist">
                                <li class="nav-item">
                                    <a class="nav-link active" id="send-email-tab" data-toggle="pill" href="#send-email"
                                       role="tab" aria-controls="send-email" aria-selected="false">Send Email</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" id="create-note-tab" data-toggle="pill"
                                       href="#create-note" role="tab" aria-controls="create-note"
                                       aria-selected="true">Create Note</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" id="text-tab" data-toggle="pill" href="#text" role="tab"
                                       aria-controls="text" aria-selected="false">Text</a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" id="log-call-tab" data-toggle="pill" href="#log-call"
                                       role="tab" aria-controls="log-call" aria-selected="true">Log Call</a>
                                </li>
                            </ul>
                            @*<div class="list-button-wrapper mr-4">
                                    <button class="btn btn-primary mr-2">How it work</button>
                                </div>*@
                        </div>
                    </div>
                </div>
                <div class="content-bg mt-3">
                    <div class="row">
                        <div class="tab-content" id="pills-tabContent">
                            @*<div class="tab-pane fade show active" id="create-note" role="tabpanel"
                                     aria-labelledby="create-note-tab">
                                    <div class="custom-card-text create-note-wrapper">

                                        <textarea>Add note and mentions here</textarea>
                                        <div class="row">
                                            <div class="col-6">
                                                <button class="btn btn-primary mr-2">
                                                    Try Team
                                                    Mentions
                                                </button>
                                            </div>
                                            <div class="col-6 text-right">
                                                <button class="btn btn-primary mr-2">
                                                    Creat
                                                    Note
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>*@
                            <input type="hidden" id="hdnLeadEmailMsgId" />
                            <input type="hidden" id="hdnEmailMessageId" />
                            <input type="hidden" id="hdnFromName" />
                            <input type="hidden" id="hdnToName" />
                            <input type="hidden" id="hdnIsReplay" />
                            <div class="tab-pane fade show active" id="send-email" role="tabpanel"
                                 aria-labelledby="send-email-tab">
                                <div class="custom-card-text create-note-wrapper">
                                    <label>To:</label>
                                    <b>
                                        @Model.EmailAddress
                                        <input type="hidden" id="hdnToMailAddress" value="@Model.EmailAddress" />
                                    </b>
                                    <p>
                                        Subject: <input type="text" id="txtMailSubject" class="form-control mb-3" />
                                    </p>
                                    <textarea id="txtMailBody" class="form-control mb-3" rows="200"></textarea>
                                    <p>
                                        Attachments:<input type="file" id="fileInputMail" multiple class="form-control mb-3" />
                                    </p>
                                    <div class="row">
                                        <div class="col-6">
                                        </div>
                                        <div class="col-6 text-right mt-3">
                                            <button type="submit" class="btn btn-primary mr-2" onclick="fnSendEmail(@Model.LeadId)">Send Email</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            @*<div class="tab-pane fade" id="text" role="tabpanel" aria-labelledby="text-tab">
                                    <div class="custom-card-text create-note-wrapper">

                                        <textarea>Add note and mentions here</textarea>
                                        <div class="row">
                                            <div class="col-6">
                                                <button class="btn btn-primary mr-2">
                                                    Try Team
                                                    Mentions
                                                </button>
                                            </div>
                                            <div class="col-6 text-right">
                                                <button class="btn btn-primary mr-2">
                                                    Creat
                                                    Note
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="tab-pane fade" id="log-call" role="tabpanel" aria-labelledby="log-call-tab">
                                    <div class="custom-card-text create-note-wrapper">

                                        <textarea>Add note and mentions here</textarea>
                                        <div class="row">
                                            <div class="col-6">
                                                <button class="btn btn-primary mr-2">
                                                    Try Team
                                                    Mentions
                                                </button>
                                            </div>
                                            <div class="col-6 text-right">
                                                <button class="btn btn-primary mr-2">
                                                    Creat
                                                    Note
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>*@
                        </div>
                    </div>
                </div>

                <div class="main-tab-wrapper mt-3" style="display:none">
                    <div class="content-bg">
                        <div class="row justify-content-between chat-listing-tab">
                            <ul class="nav nav-pills" id="pills-tab" role="tablist">
                                <li class="nav-item">
                                    <a class="nav-link active" id="all-tab" data-toggle="pill" href="#all"
                                       role="tab" aria-controls="all" aria-selected="true">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                             viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                                             stroke-linecap="round" stroke-linejoin="round"
                                             class="feather feather-list">
                                            <line x1="8" y1="6" x2="21" y2="6"></line>
                                            <line x1="8" y1="12" x2="21" y2="12"></line>
                                            <line x1="8" y1="18" x2="21" y2="18"></line>
                                            <line x1="3" y1="6" x2="3.01" y2="6"></line>
                                            <line x1="3" y1="12" x2="3.01" y2="12"></line>
                                            <line x1="3" y1="18" x2="3.01" y2="18"></line>
                                        </svg> All
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" id="send-email-tab" data-toggle="pill" href="#send-email"
                                       role="tab" aria-controls="send-email" aria-selected="false">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                             viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                                             stroke-linecap="round" stroke-linejoin="round"
                                             class="feather feather-mail">
                                            <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z">
                                            </path>
                                            <polyline points="22,6 12,13 2,6"></polyline>
                                        </svg>
                                        <span>5</span>
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" id="text-tab" data-toggle="pill" href="#text" role="tab"
                                       aria-controls="text" aria-selected="false">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                             viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                                             stroke-linecap="round" stroke-linejoin="round"
                                             class="feather feather-message-square">
                                            <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z">
                                            </path>
                                        </svg>
                                        <span>3</span>
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" id="log-call-tab" data-toggle="pill" href="#log-call"
                                       role="tab" aria-controls="log-call" aria-selected="true">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                             viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                                             stroke-linecap="round" stroke-linejoin="round"
                                             class="feather feather-phone">
                                            <path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z">
                                            </path>
                                        </svg>
                                        <span>0</span>
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" id="log-call-tab" data-toggle="pill" href="#log-call"
                                       role="tab" aria-controls="log-call" aria-selected="true">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                             viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                                             stroke-linecap="round" stroke-linejoin="round"
                                             class="feather feather-bookmark">
                                            <path d="M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"></path>
                                        </svg><span>0</span>
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" id="log-call-tab" data-toggle="pill" href="#log-call"
                                       role="tab" aria-controls="log-call" aria-selected="true">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                             viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                                             stroke-linecap="round" stroke-linejoin="round"
                                             class="feather feather-activity">
                                            <polyline points="22 12 18 12 15 21 9 3 6 12 2 12"></polyline>
                                        </svg><span>0</span>
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a class="nav-link" id="log-call-tab" data-toggle="pill" href="#log-call"
                                       role="tab" aria-controls="log-call" aria-selected="true">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                             viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                                             stroke-linecap="round" stroke-linejoin="round"
                                             class="feather feather-gift">
                                            <polyline points="20 12 20 22 4 22 4 12"></polyline>
                                            <rect x="2" y="7" width="20" height="5"></rect>
                                            <line x1="12" y1="22" x2="12" y2="7"></line>
                                            <path d="M12 7H7.5a2.5 2.5 0 0 1 0-5C11 2 12 7 12 7z"></path>
                                            <path d="M12 7h4.5a2.5 2.5 0 0 0 0-5C13 2 12 7 12 7z"></path>
                                        </svg>
                                        <path d="M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"></path>
                                        <span>0</span>
                                    </a>
                                </li>
                            </ul>
                            <div class="list-button-wrapper mr-4">
                                <button class="btn btn-primary mr-2">Filter</button>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="content-bg mt-3">
                    <div class="row">
                        <div class="tab-content" id="pills-tabContent">
                            <div class="tab-pane fade show active" id="create-note" role="tabpanel"
                                 aria-labelledby="create-note-tab">
                                <div id="divMailList">

                                </div>

                                @*<div class="custom-card-header">
                                        <div class="chat-icon btn-icon">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                                 viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                                                 stroke-linecap="round" stroke-linejoin="round"
                                                 class="feather feather-mail">
                                                <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z">
                                                </path>
                                                <polyline points="22,6 12,13 2,6"></polyline>
                                            </svg>
                                        </div>
                                        <div class="chat-header-detail flex-grow-1 ml-3">
                                            <h5>
                                                Dan Corkill
                                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"><polyline points="9 18 15 12 9 6"></polyline></svg>
                                                Ifiok Charles
                                            </h5>
                                            <span>8 days ago</span>
                                            <h5>Automate your lead engagement</h5>
                                        </div>
                                        <div class="chat-action">
                                            <button class="btn btn-secondary">Reply</button>
                                            <button class="btn btn-secondary">Reply All</button>
                                            <button class="btn btn-secondary">
                                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-more-vertical"><circle cx="12" cy="12" r="1"></circle><circle cx="12" cy="5" r="1"></circle><circle cx="12" cy="19" r="1"></circle></svg>
                                            </button>
                                        </div>
                                    </div>
                                    <div class="custom-card-text ml-5">
                                        <p> Hi Ifiok,</p>
                                        <p>Estajo can automatically pull in leads from <b>over 200 lead sources</b>. If you get online leads, you’ll want to send those directly to Estajo so we can start following up for you right away. <a href="https://follow-up-boss-2.intercom-clicks.com/via/e?ob=o3r2oUIXPQ1gyogPn4FZAfHEuMTIIB%2BLTBJahwMpfZEt0AEB8tR35N%2FQXljGWBBp6%2BqNZ2puZ8iMCEDJCl9Rolw26gZ12wurnqHYYSVgzHo%3D&amp;h=bf340fe87a517d1e77e872ccbf91cbedb5ee6556-mfhsavoz_3906303709776&amp;l=15cd337cccd2bcb041e6cbc220662e8b893ba130-2285611" style="border:none;color:#1251ba;text-decoration:underline;" target="_blank" rel="noreferrer noopener">Here is how you can send in leads</a>.</p>
                                        <p>Need help? Just hit reply.</p>
                                        <p>Regards, <br>The Estajo Team</p>
                                        <p><br></p>
                                    </div>*@
                            </div>
                            <div class="tab-pane fade" id="send-email" role="tabpanel"
                                 aria-labelledby="send-email-tab">
                                2...
                            </div>
                            <div class="tab-pane fade" id="text" role="tabpanel" aria-labelledby="text-tab">
                                3...
                            </div>
                            <div class="tab-pane fade" id="log-call" role="tabpanel" aria-labelledby="log-call-tab">
                                4...
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="~/js/select2.js"></script>
<script src="~/js/select2.min.js"></script>
<script src="~/SiteJavascripts/LeadDetail.js"></script>
<script type="text/javascript">

    $(document).ready(function () {

        $('[data-toggle="tooltip"]').tooltip();

        $("#cmbtag").select2({
            width: '100%',
        });
        $("#cmbInvitees").select2({
            width: '100%',
        });
        $('#divCustomFieldValueModel').on('hidden.bs.modal', function () {
            $('#cmbcustomFieldType').prop('selectedIndex', 0);
            //$('#txtCustomFieldValue').val('');
            //$('#txtCustomFieldValue').removeAttr("style");
            //$(this)
            //    .find("input,textarea")
            //    .val('')
            //    .end()
            //    .find("input[type=checkbox], input[type=radio]")
            //    .prop("checked", "")
            //    .end();
            //$('#txtCustomFieldValue').removeAttr("value");
            //$("input[type='email']").val('');
            //$("input[type='text']").val('');
            //$("input[type='number']").val('');
            //$("input[type='date']").val('');
        });
        var date = new Date();
        var today = new Date(date.getFullYear(), date.getMonth(), date.getDate());
        var time = date.getHours(); // + ":" + date.getMinutes()
        $('#divAppointmentsModel').on('hidden.bs.modal', function (e) {
            $(this)
                .find("input,textarea")
                .val('')
                .end()
                .find("input[type=checkbox], input[type=radio]")
                .prop("checked", "")
                .end();
            $('#cmdAppointmentType').prop('selectedIndex', 0);
            $('#cmdAppointmentOutcomes').prop('selectedIndex', 0);
            $('#datepicker').datepicker('setDate', today);//,#datepickerto
            $('#timepicker').timepicker('setTime', time);//,#timepickerto
        })


        $('#datepicker').datepicker({
            showOptions: { speed: 'fast' },
            changeMonth: false,
            changeYear: false,
            dateFormat: 'mm/dd/yy',
            gotoCurrent: true,
            startDate: today,
            todayHighlight: true,
        });
        $('#timepicker').timepicker({ 'timeFormat': 'H:i' });

        //$('#datepickerto').datepicker({
        //    showOptions: { speed: 'fast' },
        //    changeMonth: false,
        //    changeYear: false,
        //    dateFormat: 'dd/mm/yy',
        //    gotoCurrent: true,
        //    startDate: today,
        //});
        //$('#timepickerto').timepicker();

        $('#datepicker').datepicker('setDate', today);//,#datepickerto
        $('#timepicker').timepicker('setTime', time);//,#timepickerto

        $("#divScroll").niceScroll({ cursorwidth: '10px', autohidemode: false, zindex: 999 });

        $("#fileInput").on("change", function () {
            var fileInput = document.getElementById('fileInput');
            var filesize = $("#fileInput")[0].files[0].size;
            if (filesize <= 104857600) {
                $('.my-custom-scrollbar').css('height', '200px');
                //Iterating through each files selected in fileInput
                for (i = 0; i < fileInput.files.length; i++) {
                    var sfilename = fileInput.files[i].name;
                    let srandomid = Math.random().toString(36).substring(7);
                    console.log(fileInput.files[i]);
                    //formdata.append(sfilename, fileInput.files[i]);
                    var markup = "<tr id='" + srandomid + "'><td>" + sfilename + "</td><td><a href='#' onclick='DeleteFile(\"" + srandomid + "\",\"" + sfilename +
                        "\")'><i style=\"color:#BF0D1C\" class=\"fa fa-trash\" aria-hidden=\"true\"></i></a></td></tr>"; // Binding the file name
                    $("#FilesList tbody").append(markup);
                }
                chkatchtbl();
                //$('#fileInput').val('');
            }
            else {
                $("#divErrorMsgLeadFile").html("Please upload file less than 100MB.");
                $('#divErrorMsgLeadFile').show();
                document.getElementById("divErrorMsgLeadFile").classList.add("alert", "alert-danger");
                setTimeout(function () {
                    $("#divErrorMsgLeadFile").fadeOut();
                }, 5000);
                document.getElementById("fileInput").focus();
                $('#fileInput').val('');
                return;
            }

        });

        CKEDITOR.replace('txtMailBody', {
            filebrowserImageBrowseUrl: '/Lead/uploadPartial',
            filebrowserImageUploadUrl: '/Lead/UploadImage'
        })
    });
    function chkatchtbl() {
        if ($('#FilesList tr').length > 1) {
            $("#FilesList").css("display", "inline-table");
        } else {
            $("#FilesList").css("display", "none");
        }
    }
    function DeleteFile(Fileid, FileName) {
        formdata.delete(FileName)
        $("#" + Fileid).remove();
        chkatchtbl();
    }

    $('#divLeadFileModel').on('hidden.bs.modal', function (e) {
        $(this)
            .find("input,textarea,file")
            .val('')
            .end()
            .find("input[type=checkbox], input[type=radio]")
            .prop("checked", "")
            .end();
        $('#FilesList').html('');
        $('.my-custom-scrollbar').removeAttr('style');
    });
    /*$(function () {*/
    //$("#DownloadAttachment").click(function () {
    //    alert(1);
    //    var fileName = $(this).attr("name");
    //    var LeadID = $(this).attr("name1");

    //    window.location = window.location.origin + '/Lead/DownloadMailAttachmentFile?fileName=' + fileName + "&LeadId=" + LeadID;
    //});
    /*});*/
</script>
