@model IEnumerable<LeadViewModel>
@{
    ViewData["Title"] = "Index";
    Layout = "~/Views/Shared/_Layout.cshtml";
}


<div role="alert" id="divAlertMessage" style="display:none"></div>

<div class="modal fade" id="divAssignAgent" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLongTitle">Assign Agent</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div role="alert" id="divErrorMsgAgent" style="display:none"></div>
                <label>Agent:</label><select id="cmbAgent" asp-items="@(new SelectList(ViewBag.AgentList,"Key","Value"))" class="form-control">
                    <option value="0">---Select Agent--</option>
                </select>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                <button type="button" onclick="fnUpdateAgent()" class="btn btn-primary">Save changes</button>
            </div>
        </div>
    </div>
</div>
<div class="main-tab-wrapper">
    <div class="alert alert-danger" id="ErrorMsg" role="alert" style="display:none;"></div>
    <div class="alert alert-success" id="SuccessMsg" role="alert" style="display:none;"></div>
    <div class="content-bg">
        <div class="row justify-content-between">
            <ul class="nav nav-pills" id="pills-tab" role="tablist">
                <li class="nav-item">
                    <a class="nav-link active" id="pills-all-people-tab" data-toggle="pill"
                       href="#pills-all-people" role="tab" aria-controls="pills-all-people"
                       aria-selected="true">All leads <span class="number-text">(5)</span></a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" id="pills-todays-leads-tab" data-toggle="pill"
                       href="#pills-todays-leads" role="tab" aria-controls="pills-todays-leads"
                       aria-selected="false">Today's Leads <span class="number-text">(0)</span></a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" id="pills-clients-tab" data-toggle="pill" href="#pills-clients"
                       role="tab" aria-controls="pills-clients" aria-selected="false">
                        Clients <span class="number-text">(0)</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" id="pills-home-tab" data-toggle="pill" href="#pills-leads-daily"
                       role="tab" aria-controls="pills-home" aria-selected="true">
                        Leads / Daily <span class="number-text">(0)</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" id="pills-profile-tab" data-toggle="pill" href="#pills-hot-2xs-week"
                       role="tab" aria-controls="pills-profile" aria-selected="false">
                        Hot/2xs Week <span class="number-text">(0)</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" id="pills-contact-tab" data-toggle="pill"
                       href="#pills-nurture-monthly" role="tab" aria-controls="pills-contact"
                       aria-selected="false">Nurture/monthly <span class="number-text">(0)</span></a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" id="pills-profile-tab" data-toggle="pill"
                       href="#pills-pc-soi-quarterly" role="tab" aria-controls="pills-profile"
                       aria-selected="false">PC/SOI/quarterly <span class="number-text">(0)</span></a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" id="pills-more-tab" data-toggle="pill" href="#pills-more" role="tab"
                       aria-controls="pills-more" aria-selected="false">
                        More <span class="number-text">(0)</span>
                    </a>
                </li>
            </ul>
            <div class="list-button-wrapper mr-4">
                <button class="btn btn-primary mr-2">Update List</button>
                <button class="btn btn-primary">Manage List</button>
            </div>
        </div>
    </div>
</div>
<div class="content-bg mt-3">
    <div class="row">
        <div class="tab-content" id="pills-tabContent">
            <div class="tab-pane fade show active" id="pills-all-people" role="tabpanel"
                 aria-labelledby="pills-all-people-tab">

                <div class="custom-card-header">
                    <div class="content-header-left">
                        <button class="btn-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" style="display:block;margin:auto" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-mail">
                                <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z">
                                </path>
                                <polyline points="22,6 12,13 2,6"></polyline>
                            </svg>
                        </button>
                        <button class="btn-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" style="display:block;margin:auto" width="24" height="24"
                                 viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                                 stroke-linecap="round" stroke-linejoin="round" class="feather feather-user">
                                <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                                <circle cx="12" cy="7" r="4"></circle>
                            </svg>
                        </button>
                        <button class="btn-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" style="display:block;margin:auto" width="24" height="24"
                                 viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                                 stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag">
                                <path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z">
                                </path>
                                <line x1="7" y1="7" x2="7.01" y2="7"></line>
                            </svg>
                        </button>
                        <a class="btn-icon" href="#" id="btnDeleteLead" onclick="return ConfirmationDialog();">
                            <svg xmlns="http://www.w3.org/2000/svg" style="display:block;margin:auto" width="24" height="24"
                                 viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                                 stroke-linecap="round" stroke-linejoin="round"
                                 class="feather feather-trash-2">
                                <polyline points="3 6 5 6 21 6"></polyline>
                                <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2">
                                </path>
                                <line x1="10" y1="11" x2="10" y2="17"></line>
                                <line x1="14" y1="11" x2="14" y2="17"></line>
                            </svg>
                        </a>
                        <a class="btn-icon">
                            <svg xmlns="http://www.w3.org/2000/svg" style="display:block;margin:auto" width="24" height="24"
                                 viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                                 stroke-linecap="round" stroke-linejoin="round"
                                 class="feather feather-share">
                                <path d="M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8"></path>
                                <polyline points="16 6 12 2 8 6"></polyline>
                                <line x1="12" y1="2" x2="12" y2="15"></line>
                            </svg>
                        </a>
                        @{
                            int userTypeAdmin = 0;
                            if (Context.Request.Cookies.ContainsKey("UserLoginTypeId"))
                            {
                                userTypeAdmin = Convert.ToInt32(Context.Request.Cookies["UserLoginTypeId"]);
                            }

                        }
                        @if (userTypeAdmin == UserLoginType.Admin.GetHashCode())
                        {
                            <a class="btn-icon" title="Click here to add leads" asp-action="NewLead" asp-controller="Lead">
                                <svg xmlns="http://www.w3.org/2000/svg" style="display:block;margin:auto" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-plus"><line x1="12" y1="5" x2="12" y2="19"></line><line x1="5" y1="12" x2="19" y2="12"></line></svg>
                            </a>
                        }
                        </div>
                    <div class="content-header-right">
                        <button class="btn btn-primary">
                            How it work
                        </button>
                        <button class="btn btn-secondary ml-2">
                            Columns
                        </button>
                        <button class="btn btn-secondary ml-2">
                            Everyone
                        </button>
                        <button class="btn btn-secondary ml-2">
                            Filters
                        </button>
                    </div>
                </div>
                <div class="custom-card-text">
                    <table class="table" id="tblLeadList">
                        <thead>
                            <tr>
                                <th scope="col">
                                    <div class="form-checkbox-group">
                                        <input type="checkbox" id="checkAll" />
                                        <label for="checkAll"></label>
                                    </div>
                                </th>
                                <th scope="col">Name</th>
                                <th scope="col">Phone</th>
                                <th scope="col">Email</th>
                                <th scope="col">Price</th>
                                <th scope="col">Last Activity</th>
                                <th scope="col">Last Communication</th>
                                <th scope="col">Stage</th>
                                <th scope="col">Created</th>
                                <th scope="col">Agent</th>
                            </tr>
                        </thead>
                        <tbody>
                            @if (Model.Count() > 0)
                            {
                                @foreach (var item in Model)
                                {
                                    <tr>
                                        <th scope="row">
                                            <div class="form-checkbox-group">
                                                <input class="form-checkbox-group" type="checkbox" value="@item.LeadId" id="checkbox-@item.LeadId" name="checkbox-@item.LeadId" />
                                                <label for="checkbox-@item.LeadId"></label>
                                            </div>
                                        </th>
                                        <td>
                                            <div class="table-profile-detail">
                                                @if (!string.IsNullOrEmpty(item.OwnerImg))
                                                {
                                                    <div class="profile-img">
                                                        <img src="~/image/profile-img-2.jpeg" alt="user" />
                                                    </div>
                                                }

                                                <div class="profile-detail">
                                                    <input type="hidden" id="hdnAgentID" />
                                                    <input type="hidden" id="hdnLeadID" />
                                                    <a asp-action="LeadDetail" asp-route-id="@item.LeadId">@item.FirstName @item.LastName</a>
                                                </div>
                                            </div>
                                        </td>
                                        <td>
                                            <a href="#" class="table-icon-call">
                                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                                                     viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                                     stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                                                     class="feather feather-phone">
                                                    <path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z">
                                                    </path>
                                                </svg>
                                            </a>
                                            <a href="tel:@item.PhoneNumber" class="table-phone-number">@(item.PhoneNumber == null ? "N/A" : item.PhoneNumber)</a>
                                        </td>
                                        <td>@item.EmailAddress</td>
                                        <td>50000</td>
                                        <td>02/01/2021</td><!--Last Activity-->
                                        <td>02/01/2021</td><!--Last Communication-->
                                        <td>@item.Stage</td><!--Stage-->
                                        <td>@Convert.ToString(string.Format("{0:dd/MM/yyyy hh:mm}", item.CreatedDate))</td><!--Created Date-->
                                        @{
                                            userTypeAdmin = 0;
                                            if (Context.Request.Cookies.ContainsKey("UserLoginTypeId"))
                                            {
                                                userTypeAdmin = Convert.ToInt32(Context.Request.Cookies["UserLoginTypeId"]);
                                            }

                                        }
                                        @if (userTypeAdmin == UserLoginType.Admin.GetHashCode())
                                        {
                                            @if (@Convert.ToInt32(item.AgentId) <= 0)
                                            {
                                                <td><font color="red">Not Assigned</font> &nbsp;&nbsp;<a href="#" onclick="setAgentValue(0,@item.LeadId)" data-toggle="modal" data-target="#divAssignAgent"><i class="fa fa-pencil"></i></a></td>
                                            }
                                            else
                                            {
                                                <td>@item.Agent.FullName &nbsp;&nbsp;<a href="#" onclick="setAgentValue(@item.AgentId,@item.LeadId)" data-toggle="modal" data-target="#divAssignAgent"><i class="fa fa-pencil"></i></a></td>
                                            }
                                        }
                                        else
                                        {
                                            @if (@Convert.ToInt32(item.AgentId) <= 0)
                                            {
                                                <td><font color="red">Not Assigned</font> </td>
                                            }
                                            else
                                            {
                                                <td>@item.Agent.FullName </td>
                                            }
                                        }
                                    </tr>
                                }
                            }
                            else
                            {
                                <tr>
                                    <td colspan="8"><h5>No Lead Found.</h5></td>
                                </tr>
                            }
                        </tbody>
                    </table>
                </div>
            </div>
            <div class="tab-pane fade" id="pills-todays-leads" role="tabpanel"
                 aria-labelledby="pills-todays-leads-tab">
                2...
            </div>
            <div class="tab-pane fade" id="pills-clients" role="tabpanel"
                 aria-labelledby="pills-clients-tab">
                3...
            </div>
            <div class="tab-pane fade" id="pills-leads-daily" role="tabpanel"
                 aria-labelledby="pills-leads-daily-tab">
                4...
            </div>
            <div class="tab-pane fade" id="pills-hot-2xs-week" role="tabpanel"
                 aria-labelledby="pills-hot-2xs-week-tab">
                5...
            </div>
            <div class="tab-pane fade" id="pills-nurture-monthly" role="tabpanel"
                 aria-labelledby="pills-nurture-monthly-tab">
                6...
            </div>
            <div class="tab-pane fade" id="pills-pc-soi-quarterly" role="tabpanel"
                 aria-labelledby="pills-pc-soi-quarterly-tab">
                7...
            </div>
            <div class="tab-pane fade" id="pills-more" role="tabpanel" aria-labelledby="pills-more-tab">
                8...
            </div>
        </div>
    </div>
</div>
@*<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>*@
<script src="https://cdn.datatables.net/1.10.23/js/jquery.dataTables.min.js"></script>
<script type="text/javascript" src="~/SiteJavascripts/LeadList.js"></script>
<script type="text/javascript">
    $(document).ready(function () {
        /*document.getElementById("liLead").classList.add("active");*/
        $("#checkAll").click(function () {
            $('input:checkbox').not(this).prop('checked', this.checked);
        });
    });

</script>
